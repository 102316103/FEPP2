<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.syscom.fep.mybatis.ext.mapper.ApidtlExtMapper">

  <select id="queryApidtl" parameterType="map" resultType="java.util.HashMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <choose>
      <when test="webType == 'SSTQ'">
        SELECT * FROM APIDTL
      </when>
      <otherwise>
        SELECT a.*,TRUNC(NPSUNIT_FEE * 0.19,1) AS FEPTXN_TX_AMT  FROM APIDTL a
        LEFT JOIN NPSUNIT ON NPSUNIT_NO = APIDTL_BUSINESS_UNIT AND NPSUNIT_PAYTYPE = APIDTL_PAYTYPE AND NPSUNIT_FEENO = APIDTL_PAYNO
      </otherwise>
    </choose>
    where APIDTL_TX_DATE = #{apidtlTxDate,jdbcType=CHAR}
  </select>

  <select id="getApibatchTotFee" parameterType="map" resultType="java.util.HashMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    SELECT SUM(TRUNC(NPSUNIT_FEE * 0.19,1)) AS APIBATCH_TOT_FEE  FROM APIDTL a
    LEFT JOIN NPSUNIT ON NPSUNIT_NO = APIDTL_BUSINESS_UNIT AND NPSUNIT_PAYTYPE = APIDTL_PAYTYPE AND NPSUNIT_FEENO = APIDTL_PAYNO
    where APIDTL_TX_DATE = #{apidtlTxDate,jdbcType=CHAR}
  </select>
</mapper>