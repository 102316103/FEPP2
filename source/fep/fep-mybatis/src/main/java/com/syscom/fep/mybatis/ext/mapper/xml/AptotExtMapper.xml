<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.syscom.fep.mybatis.ext.mapper.AptotExtMapper">

    <select id="getAPTOTSumAmtByStDate" parameterType="map" resultType="java.util.HashMap">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        SELECT SUM(APTOT_AMT_DR-APTOT_EC_AMT_CR) AS SumAmtDR,SUM(APTOT_AMT_CR-APTOT_EC_AMT_DR) AS SumAmtCR
        FROM APTOT
        where APTOT_ST_DATE = #{aptotStDate,jdbcType=CHAR}
        AND SUBSTR(APTOT_APID,1,2) IN ('25','22','11')
    </select>
    <select id="getAPTOTByStDate" parameterType="map" resultType="java.util.HashMap">
        SELECT SUBSTR(APTOT_APID, 1, 1) AS APTOT_APID,
               SUM(APTOT_CNT_DR)        AS SumAmtCntDR,
               SUM(APTOT_AMT_DR)        AS SumAmtDR,
               SUM(APTOT_CNT_CR)        AS SumAmtCntCR,
               SUM(APTOT_AMT_CR)        AS SumAmtCR,
               SUM(APTOT_EC_CNT_DR)     AS SumECCntDR,
               SUM(APTOT_EC_AMT_DR)     AS SumECDR,
               SUM(APTOT_EC_CNT_CR)     AS SumECCntCR,
               SUM(APTOT_EC_AMT_CR)     AS SumECCR
        FROM APTOT
        WHERE (APTOT_APID LIKE '25%' OR APTOT_APID LIKE '22%' OR APTOT_APID IN (2421, 2431, 2441) OR
               (APTOT_APID LIKE '1%' AND APTOT_APID != '1511'))
          AND APTOT_ST_DATE = #{aptotStDate,jdbcType=CHAR}
        GROUP BY SUBSTR(APTOT_APID, 1, 1)
    </select>
    <select id="getAPTOTSumAmtByStDateAPIDKind" parameterType="map" resultType="java.util.HashMap">
        SELECT SUM(APTOT_CNT_DR) AS CNT_DR,SUM(APTOT_AMT_DR) AS AMT_DR,
        SUM(APTOT_CNT_CR) AS CNT_CR,SUM(APTOT_AMT_CR) AS AMT_CR,
        SUM(APTOT_EC_CNT_DR) AS EC_CNT_DR,SUM(APTOT_EC_AMT_DR) AS EC_AMT_DR,
        SUM(APTOT_EC_CNT_CR) AS EC_CNT_CR,SUM(APTOT_EC_AMT_CR) AS EC_AMT_CR,
        SUM(APTOT_FEE_CNT_DR) AS FEE_CNT_DR,SUM(APTOT_FEE_AMT_DR) AS FEE_AMT_DR,
        SUM(APTOT_FEE_CNT_CR) AS FEE_CNT_CR,SUM(APTOT_FEE_AMT_CR) AS FEE_AMT_CR,
        SUM(APTOT_EC_FEE_CNT_DR) AS EC_FEE_CNT_DR,SUM(APTOT_EC_FEE_AMT_DR) AS EC_FEE_AMT_DR,
        SUM(APTOT_EC_FEE_CNT_CR) AS EC_FEE_CNT_CR,SUM(APTOT_EC_FEE_AMT_CR) AS EC_FEE_AMT_CR
        FROM APTOT
        <where>
            <if test="aptotStDate != null">
                AND APTOT_ST_DATE = #{aptotStDate,jdbcType=VARCHAR}
            </if>
            <if test="ascFlag != null">
                AND APTOT_ASC_FLAG = #{ascFlag,jdbcType=VARCHAR}
            </if>
            <if test="apId != null">
                AND APTOT_APID = #{apId,jdbcType=VARCHAR}
            </if>
        </where>
    </select>
    <update id="updateForRMProcessAPTOT" parameterType="com.syscom.fep.mybatis.model.Aptot">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        update APTOT
        <set>
            <if test="aptotCntDr != null">
                APTOT_CNT_DR = #{aptotCntDr,jdbcType=INTEGER} + NVL(APTOT_CNT_DR, 0),
            </if>
            <if test="aptotAmtDr != null">
                APTOT_AMT_DR = #{aptotAmtDr,jdbcType=DECIMAL} + NVL(APTOT_AMT_DR, 0),
            </if>
            <if test="aptotCntCr != null">
                APTOT_CNT_CR = #{aptotCntCr,jdbcType=INTEGER} + NVL(APTOT_CNT_CR, 0),
            </if>
            <if test="aptotAmtCr != null">
                APTOT_AMT_CR = #{aptotAmtCr,jdbcType=DECIMAL} + NVL(APTOT_AMT_CR, 0),
            </if>
            <if test="aptotEcCntDr != null">
                APTOT_EC_CNT_DR = #{aptotEcCntDr,jdbcType=INTEGER} + NVL(APTOT_EC_CNT_DR, 0),
            </if>
            <if test="aptotEcAmtDr != null">
                APTOT_EC_AMT_DR = #{aptotEcAmtDr,jdbcType=DECIMAL} + NVL(APTOT_EC_AMT_DR, 0),
            </if>
            <if test="aptotEcCntCr != null">
                APTOT_EC_CNT_CR = #{aptotEcCntCr,jdbcType=INTEGER} + NVL(APTOT_EC_CNT_CR, 0),
            </if>
            <if test="aptotEcAmtCr != null">
                APTOT_EC_AMT_CR = #{aptotEcAmtCr,jdbcType=DECIMAL} + NVL(APTOT_EC_AMT_CR, 0),
            </if>
            <if test="aptotEcFeeCntDr != null">
                APTOT_EC_FEE_CNT_DR = #{aptotEcFeeCntDr,jdbcType=INTEGER} + NVL(APTOT_EC_FEE_CNT_DR, 0),
            </if>
            <if test="aptotEcFeeAmtDr != null">
                APTOT_EC_FEE_AMT_DR = #{aptotEcFeeAmtDr,jdbcType=DECIMAL} + NVL(APTOT_EC_FEE_AMT_DR, 0),
            </if>
            <if test="aptotEcFeeCntCr != null">
                APTOT_EC_FEE_CNT_CR = #{aptotEcFeeCntCr,jdbcType=INTEGER} + NVL(APTOT_EC_FEE_CNT_CR, 0),
            </if>
            <if test="aptotEcFeeAmtCr != null">
                APTOT_EC_FEE_AMT_CR = #{aptotEcFeeAmtCr,jdbcType=DECIMAL} + NVL(APTOT_EC_FEE_AMT_CR, 0),
            </if>
            <if test="updateUserid != null">
                UPDATE_USERID = #{updateUserid,jdbcType=INTEGER},
            </if>
            <if test="updateTime != null">
                UPDATE_TIME = SYSDATE,
            </if>
        </set>
        where APTOT_ST_DATE = #{aptotStDate,jdbcType=CHAR}
        and APTOT_APID = #{aptotApid,jdbcType=CHAR}
        and APTOT_BRNO = #{aptotBrno,jdbcType=CHAR}
        and APTOT_ASC_FLAG = #{aptotAscFlag,jdbcType=SMALLINT}
    </update>
</mapper>